ѕротокол обмена верси€ 0.1:

C<data>#<control sum>\n
C<code>\n
<data>#<control sum>\n

<code> ::= OK | ERROR | <other code>
<control sum> ::= <sum of all bytes data till # (command excluded, # excluded)> mod 65536


ќбмен инициируетс€ клиентом (андроид, rpi).
1. ѕослать однобайтовую команду
2. ∆дать ответа (тот же байт, что был послан) в течение 1 секунды
3. ≈сли ответ не пришел или ответ неправильный, передать \n (0x0A) и повторить (или ошибка)
4. ѕередать данные, #, контрольную сумму, \n
5. ѕолучить код возврата (до \n)
5. ѕолучить данные, если они есть по протоколу (до \n)

«агрузка расписани€ выключает полив, если он производилс€ в момент загрузки.

 оманды.

V - получить версию ѕќ
-> V#0\n
<- VOK\n
<- 0.1#143\n

S - установить часы
-> S2014-06-26 22:58:00#xxxx\n
<- SOK\n

G - получить показани€ часов
-> G#0\n
<- GOK\n
<- 2014-06-26 22:58:00#xxxx\n

D - получить показание датчика
-> D<номер датчика>#<контр>\n
<- DOK\n
<- <значение>#<контр>\n

N - получить число поливалок
-> N#0\n
<- NOK\n
<- 3#51\n

L - получить расписание полива
-> L#0\n
<- LOK\n
<- <строка;...;строка;>#<контр>\n

T - загрузить расписание полива
-> T<строка;...;строка;>#<контр>\n
<- TOK\n


‘ормат строк в расписании.
flags:n:volume:start:period
flags:n:volume:sensor:value

flags ::= 0..15
 0000awre - двоичное представление
   a - включить сигнал
   w - полить
   r - тип контрол€ значени€: 0 - sensor<value, 1 - sensor>value
   e - 0 - disabled, 1 - enabled
n ::= номер устройства дл€ полива (начина€ с 1?)
volume ::= длительность [полива] (в секундах?)
start  ::= врем€ первого действи€ (в минутах от 01.01.2014 00:00)
period ::= период действи€ (в минутах); должен быть больше, чем длительность
sensor ::= номер сенсора, значение которого провер€етс€
value  ::= значение, с которым сравниваетс€ значение сенсора



“олько дл€ отладки:
X - проверить состо€ние pinN
-> XN#xx\n
<- XOK\n
<- Pin N is HIGH/LOW#xxx\n
Y - включить у-во на pinN
-> YN#xx\n
<- YOK\n
Z - выключить у-во на pinN
-> ZN#xx\n
<- ZOK\n
P - выключить насос и клапана